** ''25.12.16

sparrow
https://13.125.29.179:18080/

secuMS

K-RMF 관리도구



언어별 취약점 분류 및 MD 문서화 계획
목표
프로젝트 내 모든 파일을 검사하여 언어별(Java, XML)로 취약점을 분류하고, 취약점 유형별로 정리한 마크다운 문서를 생성합니다.

작업 단계
1. 파일 분석 및 취약점 분류
모든 Java 파일과 XML 파일을 검사
파일명, 주석, 코드 패턴을 분석하여 취약점 유형 파악
주요 취약점 카테고리:
보안 취약점: XSS, SQL Injection, CSRF, Path Traversal, Deserialization, Authentication/Authorization, Cryptography, Android-specific
코드 품질: Code Convention (cc 폴더)
CERT 규칙: CERT Coding Standards (cert 폴더)
2. 언어별 분류
Java 파일: 
보안 취약점 (android/, com/fasoo/, 루트의 보안 관련 파일)
코드 컨벤션 (cc/)
CERT 규칙 (cert/)
XML 파일:
SQL Injection (MyBatis/iBatis 매퍼 파일)
Android Manifest 보안 설정
3. MD 문서 생성
VULNERABILITY_CLASSIFICATION.md 파일 생성
구조:
개요
Java 취약점 분류
보안 취약점
코드 컨벤션
CERT 규칙
XML 취약점 분류
SQL Injection
Android Manifest
통계 요약
주요 파일 경로
Java 보안 취약점: android/, com/fasoo/syn/security/, com/fasoo/sem/
Java 코드 컨벤션: cc/
Java CERT 규칙: cert/
XML SQL Injection: SQL_INJECTION_MYBATIS.xml, SQL_INJECTION.IBATIS_TestCase.xml
XML Android Manifest: android/ANDROID_MANIFEST_*.xml
예상 결과
각 취약점 유형별로 파일 목록과 간단한 설명이 포함된 체계적인 분류 문서가 생성됩니다.



소스코드 취약점 분석 결과
폴더 내 파일을 검사해 언어별 취약점을 분류했습니다.
1. Java 언어 취약점
높음 (High)
Command Injection (명령어 주입) - 3건
소스코드/h2/h2/src/tools/org/h2/dev/util/Migrate.java:218
Runtime.getRuntime().exec(command) 사용
사용자 입력 검증 없이 실행될 경우 취약
소스코드/h2/h2/src/tools/org/h2/dev/ftp/server/FtpServer.java:456, 468
Runtime.getRuntime().exec("jar -xf " + path) - path 변수 검증 필요
Runtime.getRuntime().exec(command) - Properties에서 로드된 command 검증 필요
중간 (Medium)
Hardcoded Passwords (하드코딩된 비밀번호) - 3건
소스코드/hikaricp/src/main/java/com/zaxxer/hikari/util/DriverDataSource.java:36
PASSWORD = "password" - 기본 비밀번호 하드코딩
소스코드/h2/h2/src/tools/org/h2/dev/util/Migrate.java:37
PASSWORD = "sa" - H2 기본 비밀번호
소스코드/h2/h2/src/tools/org/h2/dev/ftp/server/FtpServer.java:63
DEFAULT_WRITE_PASSWORD = "sa" - FTP 기본 비밀번호
SQL Injection 가능성 - 1건
소스코드/h2/h2/src/tools/org/h2/build/doc/UploadBuild.java:125
문자열 연결로 SQL 쿼리 생성 ("insert into item..." + now + ...)
now 변수가 사용자 입력인 경우 취약
Path Traversal 가능성 - 2건
소스코드/h2/h2/src/tools/org/h2/dev/util/Migrate.java:98
파일 경로 조작 가능성
소스코드/hikaricp/src/main/java/com/zaxxer/hikari/util/JavassistProxyFactory.java:101, 178
경로 변수 검증 필요
낮음 (Low)
Insecure Random - 테스트 코드
소스코드/h2/h2/src/test/org/h2/test/unit/TestUtils.java:165
테스트 코드에서 new Random() 사용 (보안이 필요한 경우 SecureRandom 권장)
2. C/C++ 언어 취약점
높음 (High)
Buffer Overflow 가능성 - 3건
소스코드/libexpat/expat/xmlwf/xmlmime.c:127
strcpy(charset, "us-ascii") 사용
소스코드/libexpat/expat/xmlwf/ct.c:122
strcpy(charset, "us-ascii") 사용
소스코드/libexpat/expat/xmlwf/xmltchar.h:67-68
#define tcscpy strcpy, #define tcscat strcat 매크로 사용
중간 (Medium)
Format String 취약점 가능성 - 다수
소스코드/libexpat/expat/tests/runtests.c (다수 위치)
sprintf() 사용
소스코드/libexpat/expat/xmlwf/xmlwf.c (다수 위치)
ftprintf() 사용
Memory Management 이슈
소스코드/libexpat/expat/lib/xmlparse.c 및 기타 파일들
malloc, free, realloc 사용 다수
Use After Free, Double Free 가능성 검토 필요
3. Python 언어 취약점
낮음 (Low)
소스코드/libexpat/expat/xmlwf/xmlwf_helpgen.py
소스코드/libexpat/expat/tests/udiffer.py
분석 결과: Command Injection, Path Traversal, eval/exec 사용 패턴 발견되지 않음
4. Shell Script 취약점
중간 (Medium)
Command Injection 가능성 - 1건
소스코드/libexpat/expat/tests/xmltest.sh:131
for xmlfile in $(ls -1 *.xml | sort -d) - 명령어 치환 사용
파일명에 특수 문자가 포함된 경우 예상치 못한 동작 가능
종합 요약
심각도별 통계
높음: 6건 (Java Command Injection 3건, C/C++ Buffer Overflow 3건)
중간: 10건 이상 (Hardcoded Passwords, SQL Injection, Path Traversal, Format String, Memory Management 등)
낮음: 1건 (테스트 코드 Insecure Random)
즉시 조치 권장 사항
Command Injection 취약점 수정 (ProcessBuilder 사용, 입력 검증)
하드코딩된 비밀번호 제거 (환경 변수 또는 보안 설정 파일 사용)
SQL Injection 방지 (PreparedStatement 사용)
C/C++ 안전한 문자열 함수로 교체 (strncpy, snprintf 등)
분석은 정적 코드 분석 기반이며, 실제 취약점 여부는 동적 분석과 상세 코드 리뷰로 확인이 필요합니다



